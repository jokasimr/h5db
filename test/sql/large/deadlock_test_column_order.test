# name: test/sql/large/deadlock_test_column_order.test
# description: First query: time_offset then event_id, Second: event_id then time_offset
# group: [large]

require h5db

# First query: time_offset, event_id
query I
SELECT COUNT(*) FROM (
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_1/time_offset', '/detector_1/event_id')
  UNION ALL
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_2/time_offset', '/detector_2/event_id')
  UNION ALL
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_3/time_offset', '/detector_3/event_id')
);
----
6000000

# Second query: REVERSE ORDER - event_id, time_offset
query I
SELECT COUNT(*) FROM (
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_1/event_id', '/detector_1/time_offset')
  UNION ALL
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_2/event_id', '/detector_2/time_offset')
  UNION ALL
  SELECT * FROM h5_read('test/data/large/large_multithreading.h5',
      '/detector_3/event_id', '/detector_3/time_offset')
);
----
6000000
