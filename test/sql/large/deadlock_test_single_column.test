# name: test/sql/large/deadlock_test_single_column.test
# description: Test 3 detectors Ã— 2 with only ONE column (not two)
# group: [large]

require h5db

# First query: single column
query I
SELECT COUNT(*) FROM (
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_1/event_id')
  UNION ALL
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_2/event_id')
  UNION ALL
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_3/event_id')
);
----
6000000

# Second query: same single column
query I
SELECT COUNT(*) FROM (
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_1/event_id')
  UNION ALL
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_2/event_id')
  UNION ALL
  SELECT event_id FROM h5_read('test/data/large/large_multithreading.h5', '/detector_3/event_id')
);
----
6000000
