# name: test/sql/large/deadlock_test_no_union.test
# description: No UNION ALL - just read same 3 datasets twice sequentially
# group: [large]

require h5db

# First set of reads
query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_1/time_offset', '/detector_1/event_id');
----
2000000

query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_2/time_offset', '/detector_2/event_id');
----
2000000

query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_3/time_offset', '/detector_3/event_id');
----
2000000

# Second set - repeat same reads
query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_1/time_offset', '/detector_1/event_id');
----
2000000

query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_2/time_offset', '/detector_2/event_id');
----
2000000

query I
SELECT COUNT(*) FROM h5_read('test/data/large/large_multithreading.h5',
    '/detector_3/time_offset', '/detector_3/event_id');
----
2000000
